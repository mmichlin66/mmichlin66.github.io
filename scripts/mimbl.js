!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("mimurl")):"function"==typeof define&&define.amd?define(["mimurl"],t):"object"==typeof exports?exports.mimbl=t(require("mimurl")):e.mimbl=t(e.mimurl)}(this,function(e){return function(e){var t={};function s(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(i,r,function(t){return e[t]}.bind(null,r));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=6)}([function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))(function(r,n){function o(e){try{u(i.next(e))}catch(e){n(e)}}function l(e){try{u(i.throw(e))}catch(e){n(e)}}function u(e){e.done?r(e.value):new s(function(t){t(e.value)}).then(o,l)}u((i=i.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const r=s(3);class n{constructor(e){this.site=void 0,this.props=e}setSite(e){this.site=e,void 0!==e&&void 0!==this.dispalyName&&this.site.setDisplayName(this.dispalyName)}setDisplayName(e){this.dispalyName=e,void 0!==this.site&&this.site.setDisplayName(e)}updateMe(){void 0!==this.site&&this.site.requestUpdate()}ignoreMe(){null!==this.site&&this.site.cancelUpdate()}callMe(e,t=!1){null!==this.site&&this.site.scheduleCall(e,t)}dontCallMe(e,t=!1){null!==this.site&&this.site.cancelScheduledCall(e,t)}}t.Component=n;t.Ref=class{constructor(e,t){this.changedEvent=new r.EventSlot,void 0!==e&&this.changedEvent.add(e),this._r=t}addListener(e){this.changedEvent.add(e)}removeListener(e){this.changedEvent.remove(e)}get r(){return this._r}set r(e){this._r!==e&&(this._r=e,this.changedEvent.fire(e))}clear(){this._r=void 0,this.changedEvent.clear()}},t.setRef=function(e,t,s){if("object"==typeof e){let i=e;void 0!==s&&i.r!==s||(i.r=t)}else"function"==typeof e&&e(t)},t.prop=function(e,t){let s="_m_"+t;Object.defineProperty(e,t,{set(e){this[s]!==e&&(this[s]=e,this.updateMe())},get(){return this[s]}})},t.Placeholder=function(e){},t.registerCustomAttribute=function(e,t){!function(e,t){l.ElmAttr.registerProperty(e,{type:3,factory:t})}(e,t)};t.FuncProxy=class extends n{constructor(e){super(),this.update=(()=>{this.site&&this.site.requestUpdate()}),this.func=e}render(){return this.func()}};t.Waiting=class extends n{constructor(e,t,s){super(),this.content=t,this.watchPromise(e,s)}render(){return this.content}watchPromise(e,t){return i(this,void 0,void 0,function*(){try{this.content=yield e}catch(e){if(this.content=null,void 0!==t)try{this.content=t(e)}catch(e){}}})}},t.isSvg=function(e){return"ownerSVGElement"in e},t.isSvgSvg=function(e){return null===e.ownerSVGElement};const o=s(7);t.jsx=function(e,t,...s){let i=1===s.length&&Array.isArray(s[0])?s[0]:s;return o.createVNChainFromJSX(e,t,i)},t.mountSync=function(e,t=null){o.RootVN.mountRootSync(e,t)},t.unmountSync=function(e=null){o.RootVN.unmountRootSync(e)},t.mount=function(e,t=null){o.RootVN.mountRoot(e,t)},t.unmount=function(e=null){o.RootVN.unmountRoot(e)};const l=s(2)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),r=s(4);t.VN=class{constructor(e){this.next=null,this.prev=null,this.subNodes=new r.VNChain,this.anchorDN=null,this.type=e}get Type(){return this.type}get Parent(){return this.parent}get Next(){return this.next}get Prev(){return this.prev}get SubNodes(){return this.subNodes}get DisplayName(){return this.name}initialize(e){this.parent=e,null===e?(this.root=this,this.depth=0):(this.root=e.root,this.depth=e.depth+1)}terminate(){void 0!==this.publishedServices&&(this.publishedServices.forEach((e,t)=>this.root.notifyServiceUnpublished(t,this)),this.publishedServices.clear()),void 0!==this.subscribedServices&&(this.subscribedServices.forEach((e,t)=>{this.root.notifyServiceUnsubscribed(t,this)}),this.subscribedServices.clear()),this.anchorDN=null,this.subNodes.clear(),this.root=null,this.parent=null,this.depth=0}render(){}willMount(){}mount(){}didMount(){}willUnmount(){}unmount(){}isUpdatePossible(e){return!1}prepareUpdate(e){return{shouldCommit:!1,shouldRender:!1}}commitUpdate(e){}didUpdate(){}supportsErrorHandling(){return!1}handleError(e,t){}getOwnDN(){return null}getFirstDN(){let e=this.getOwnDN();if(null!==e)return e;if(null!==this.subNodes.first)for(let t=this.subNodes.first;null!==t;t=t.next)if(null!==(e=t.getFirstDN()))return e;return null}setDisplayName(e){this.name=e}requestUpdate(){this.root&&this.root.requestNodeUpdate(this)}cancelUpdate(){this.root&&this.root.cancelNodeUpdate(this)}scheduleCall(e,t=!1){this.root&&this.root.scheduleFuncCall(e,t)}cancelScheduledCall(e,t=!1){this.root&&this.root.cancelScheduledFuncCall(e,t)}publishService(e,t){void 0===this.publishedServices&&(this.publishedServices=new Map),this.publishedServices.get(e)!==t&&(this.publishedServices.set(e,t),this.root.notifyServicePublished(e,this))}unpublishService(e){void 0!==this.publishedServices&&(this.publishedServices.delete(e),this.root.notifyServiceUnpublished(e,this),0===this.publishedServices.size&&(this.publishedServices=void 0))}subscribeService(e,t,s,r){void 0===this.subscribedServices&&(this.subscribedServices=new Map);let o=new n;o.ref=t,o.defaultService=s,o.useSelf=!!r,this.subscribedServices.set(e,o),this.root.notifyServiceSubscribed(e,this),i.setRef(t,this.getService(e,s))}unsubscribeService(e){if(void 0===this.subscribedServices)return;let t=this.subscribedServices.get(e);void 0!==t&&(i.setRef(t.ref,void 0),this.subscribedServices.delete(e),this.root.notifyServiceUnsubscribed(e,this),0===this.subscribedServices.size&&(this.subscribedServices=void 0))}notifyServiceChanged(e){if(void 0===this.subscribedServices)return;let t=this.subscribedServices.get(e);void 0!==t&&i.setRef(t.ref,this.getService(e,t.defaultService))}getService(e,t,s){let i=this.findService(e,s);return void 0!==i?i:t}findService(e,t){if(t&&void 0!==this.publishedServices){let t=this.publishedServices.get(e);if(void 0!==t)return t}return null!==this.parent?this.parent.findService(e,!0):void 0}getNextDNUnderSameAnchorDN(e){if(null!==this.subNodes.last){const e=this.subNodes.last.getFirstDN();if(null!==e){const t=e.nextSibling;if(null!==t)return t}}for(let t=this.next;null!==t;t=t.next){if(t.anchorDN!==e)return null;const s=t.getFirstDN();if(null!==s)return s}return null!==this.parent&&this.parent.anchorDN===e?this.parent.getNextDNUnderSameAnchorDN(e):null}get path(){let e=this.depth,t=Array(e);for(let s=0,i=this;s<e;s++,i=i.parent)t[s]=i.name;return t}get IsMounted(){return null!==this.anchorDN}toString(){return this.name}};class n{}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{static registerProperty(e,t){i.propInfos[e]=t}static getPropertyInfo(e){return i.propInfos[e]}static setAttr(e,t,s,i){if(void 0===s)e.setAttribute(t,"string"==typeof i?i:i.toString());else{let r=s.attrName;void 0===r&&(r=t),void 0!==s.set?s.set(e,r,i):e.setAttribute(r,"string"==typeof i?i:i.toString())}}static updateAttr(e,t,s,i,r){if(void 0===s)return i!==r&&(e.setAttribute(t,"string"==typeof r?r:r.toString()),!0);let n;if(void 0!==s.diff){if(void 0===(n=s.diff(t,i,r)))return!1}else i!==r&&(n=r);let o=s.attrName;return void 0===o&&(o=t),void 0!==s.update?s.update(e,o,n):(void 0!==s.remove&&s.remove(e,o),void 0!==s.set?s.set(e,o,n):e.setAttribute(o,"string"==typeof n?n:n.toString())),!0}static removeAttr(e,t,s){if(void 0===s)e.removeAttribute(t);else{let i=s.attrName;void 0===i&&(i=t),void 0!==s.remove?s.remove(e,i):e.removeAttribute(i)}}}function r(e,t,s){e.value=s}function n(e,t,s){}function o(e,t){}function l(e,t,s){e.checked=s}i.propInfos={style:{type:1,set:function(e,t,s){if(null==s)e.removeAttribute("style");else{const t=e.style;for(let e in s){const i=s[e];t[e]!==i&&(t[e]=i)}}},diff:function(e,t,s){if(typeof t!=typeof s)return s;{const e=t,i=s,r={};let n=!1;for(let t in e){const s=e[t],o=i[t];void 0===o?(n=!0,r[t]=void 0):o!==s&&(n=!0,r[t]=o)}for(let t in i){const s=e[t];void 0===s&&(n=!0,r[t]=i[t])}return n?r:void 0}},update:function(e,t,s){const i=e.style;for(let e in s){const t=s[e];i[e]=void 0===t?null:t}}},value:{type:1,set:r,diff:function(e,t,s){return s},remove:function(e,t){e.value=null}},defaultValue:{type:1,set:r,diff:n,remove:o},checked:{type:1,set:l,diff:function(e,t,s){return s},remove:function(e,t){e.checked=!1}},defaultChecked:{type:1,set:l,diff:n,remove:o},mouseenter:{type:2,isBubbling:!1},mouseleave:{type:2,isBubbling:!1}},t.ElmAttr=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.fire=this.realFire,this.listeners=null}add(e){null===this.listeners&&(this.listeners=new Set),this.listeners.add(e)}remove(e){null!==this.listeners&&(this.listeners.delete(e),0===this.listeners.size&&(this.listeners=null))}clear(){this.listeners=null}realFire(){if(null!==this.listeners)for(let e of this.listeners)e(...arguments)}}t.EventSlot=i;t.EventMultiSlot=class{addListener(e,t){void 0===this.slots&&(this.slots=new Map);let s=this.slots.get(e);void 0===s&&(s=new i,this.slots.set(e,s)),s.add(t)}removeListener(e,t){if(void 0!==this.slots){let s=this.slots.get(e);void 0!==s&&s.remove(t)}}};t.SimpleEventSlot=class extends i{}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VNChain=class{constructor(e){this.first=null,this.last=null,this.count=0,void 0!==e&&null!=e&&this.appendVN(e)}get First(){return this.first}get Last(){return this.last}get Count(){return this.count}clear(){this.first=this.last=null,this.count=0}appendVN(e){null!==e&&(e.prev=this.last,null===this.first?this.first=this.last=e:(this.last.next=e,this.last=e),e.next=null,this.count++)}appendChain(e){null!==e&&null!==e.first&&(e.first.prev=this.last,null===this.first?(this.first=e.first,this.last=e.last):(this.last.next=e.first,this.last=e.last),e.last.next=null,this.count+=e.count)}insertVN(e){null!==e&&(e.next=this.first,null===this.first?this.first=this.last=e:(this.first.prev=e,this.first=e),e.prev=null,this.count++)}replaceVNWithChain(e,t){if(null===e||null===t)return;let s=e.prev,i=e.next;this.first===e&&(this.first=t.first),this.last===e&&(this.last=t.last),null!==s&&(s.next=t.first),null!=i&&(i.prev=t.last),this.count+=t.count-1}deleteVN(e){if(null===e)return;let t=e.prev,s=e.next;this.first===e&&(this.first=s),this.last===e&&(this.last=t),null!==t&&(t.next=s),null!=s&&(s.prev=t),this.count--}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(1);t.CompBaseVN=class extends i.VN{constructor(e){super(e)}render(){return this.comp.render()}supportsErrorHandling(){return void 0!==this.comp.handleError}handleError(e,t){this.comp.handleError(e,t)}didMount(){this.comp.componentDidMount&&this.comp.componentDidMount()}didUpdate(){this.comp.componentDidUpdate&&this.comp.componentDidUpdate()}getOwnDN(){return null}}},function(e,t,s){"use strict";function i(e){for(var s in e)t.hasOwnProperty(s)||(t[s]=e[s])}Object.defineProperty(t,"__esModule",{value:!0}),i(s(0)),i(s(2)),i(s(15)),i(s(3)),i(s(16)),i(s(17))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),r=s(1),n=s(4),o=s(8);let l=window.requestIdleCallback?window.requestIdleCallback:e=>setTimeout(e);class u extends r.VN{constructor(e){super(0),this.onScheduledFrame=(()=>{this.scheduledFrameHandle=0;let e=this.vnsScheduledForUpdate;this.vnsScheduledForUpdate=new Set;const t=this.callsScheduledBeforeUpdate;this.callsScheduledBeforeUpdate=new Set;const s=this.callsScheduledAfterUpdate;this.callsScheduledAfterUpdate=new Set,this.performUpdateCycle(e,t,s)}),this.errorUI=null,this.waitingUI=null,this.thrownPromises=new Set,this.serviceInfos=new Map,this.vnsScheduledForUpdate=new Set,this.callsScheduledBeforeUpdate=new Set,this.callsScheduledAfterUpdate=new Set,this.scheduledFrameHandle=0,this.currentTick=0,this.currentVN=null,this.anchorDN=e,this.name="Root",this.initialize(null),this.content=null,this.willMount()}setContent(e,t){if(this.content=e,t){let e=new Set;e.add(this),this.performUpdateCycle(e)}else this.requestNodeUpdate(this)}static mountRootSync(e,t){let s=t||document.body,i=s[u.mimblAnchorPropName];i||(i=new u(s),s[u.mimblAnchorPropName]=i),i.setContent(e,!0)}static unmountRootSync(e){let t=e||document.body;if(!t)return;let s=t[u.mimblAnchorPropName];s&&(delete t[u.mimblAnchorPropName],s.setContent(null,!0),s.willUnmount())}static mountRoot(e,t){let s=t||document.body,i=s[u.mimblAnchorPropName];i||(i=new u(s),s[u.mimblAnchorPropName]=i),i.setContent(e,!1)}static unmountRoot(e){let t=e||document.body;if(!t)return;let s=t[u.mimblAnchorPropName];s&&(delete t[u.mimblAnchorPropName],s.setContent(null,!1),s.scheduleCall(()=>s.willUnmount()))}render(){return this.errorUI?this.errorUI:this.waitingUI?this.waitingUI:this.content}willMount(){this.publishService("StdErrorHandling",this)}willUnmount(){this.unpublishService("StdErrorHandling")}isUpdatePossible(e){return!0}supportsErrorHandling(){return!0}handleError(e,t){if(e instanceof Promise){let t=e;this.thrownPromises.add(t),t.then(()=>{this.onPromiseFulfilled(t)}),t.catch(()=>{this.onPromiseFulfilled(t)}),this.waitingUI||(this.waitingUI=new o.RootWaitingUI)}else this.errorUI=new o.RootErrorUI(this,e,t)}getOwnDN(){return null}restart(){this.errorUI=null,this.requestUpdate()}notifyServicePublished(e,t){let s=this.serviceInfos.get(e);void 0===s&&(s=new h,this.serviceInfos.set(e,s)),s.publishingVNs.add(t);for(let t of s.subscribedVNs)t.notifyServiceChanged(e)}notifyServiceUnpublished(e,t){let s=this.serviceInfos.get(e);if(void 0!==s)if(s.publishingVNs.delete(t),0===s.publishingVNs.size&&0===s.subscribedVNs.size)this.serviceInfos.delete(e);else for(let t of s.subscribedVNs)t.notifyServiceChanged(e)}notifyServiceSubscribed(e,t){let s=this.serviceInfos.get(e);void 0===s&&(s=new h,this.serviceInfos.set(e,s)),s.subscribedVNs.add(t)}notifyServiceUnsubscribed(e,t){let s=this.serviceInfos.get(e);void 0!==s&&(s.subscribedVNs.delete(t),0===s.publishingVNs.size&&0===s.subscribedVNs.size&&this.serviceInfos.delete(e))}requestNodeUpdate(e){this.vnsScheduledForUpdate.add(e),this.requestFrameIfNeeded()}cancelNodeUpdate(e){this.vnsScheduledForUpdate.delete(e)&&this.cancelFrameRequestIfNeeded()}scheduleFuncCall(e,t=!1){e&&(t?this.callsScheduledBeforeUpdate.add(e):this.callsScheduledAfterUpdate.add(e),this.requestFrameIfNeeded())}cancelScheduledFuncCall(e,t=!1){e&&(t?this.callsScheduledBeforeUpdate.delete(e):this.callsScheduledAfterUpdate.delete(e),this.cancelFrameRequestIfNeeded())}reportError(e,t){this.handleError(e,t),this.requestUpdate()}onPromiseFulfilled(e){this.thrownPromises.delete(e),0===this.thrownPromises.size&&(this.waitingUI=null,this.requestUpdate())}requestFrameIfNeeded(){0===this.scheduledFrameHandle&&(this.scheduledFrameHandle=l(this.onScheduledFrame))}cancelFrameRequestIfNeeded(){0===this.vnsScheduledForUpdate.size&&0===this.callsScheduledBeforeUpdate.size&&0===this.callsScheduledAfterUpdate.size&&(window.cancelIdleCallback(this.scheduledFrameHandle),this.scheduledFrameHandle=0)}performUpdateCycle(e,t,s){this.currentTick++,t&&this.callScheduledFunctions(t,"before"),this.performCommitPhase(this.performRenderPhase(this.arrangeNodesByDepth(e))),s&&this.callScheduledFunctions(s,"after")}arrangeNodesByDepth(e){let t=new Array(100);return e.forEach(e=>{let s=t[e.depth];s||(s=[],t[e.depth]=s),s.push(e)}),t}performRenderPhase(e){let t=[];return e.forEach(e=>{e.forEach(e=>{try{if(e.lastUpdateTick===this.currentTick)return;t.push(this.updateStemVirtual(e))}catch(t){e.findService("StdErrorHandling",!1).reportError(t,this.currentVN?this.currentVN.path:null)}this.currentVN=null})}),t}callScheduledFunctions(e,t){e.forEach(e=>{try{e()}catch(e){console.error(`Exception while invoking function ${t} updating components\n`,e)}})}performCommitPhase(e){e.forEach(e=>{this.preUpdatePhysical(e)}),e.forEach(e=>{this.updatePhysical(e)}),e.forEach(e=>{this.postUpdate(e)})}createVirtual(e,t){e.initialize(t);let s=e;if(this.currentVN=s,e.willMount(),e.supportsErrorHandling())try{this.createSubNodesVirtual(e)}catch(t){e.handleError(t,this.currentVN.path),this.createSubNodesVirtual(e)}else this.createSubNodesVirtual(e);this.currentVN=s}createSubNodesVirtual(e){let t=v(e.render());for(let s=t.first;null!==s;s=s.next)this.createVirtual(s,e);e.subNodes=t}createPhysical(e,t,s){e.anchorDN=t,e.mount();let i=e.getOwnDN();if(null!==i&&e.anchorDN.insertBefore(i,s),e.subNodes.count>0){let r=null===i?t:i,n=null===i?s:null;for(let t=e.subNodes.first;null!==t;t=t.next)this.createPhysical(t,r,n)}}postCreate(e){try{e.didMount()}catch(t){console.error(`Node ${e.name} threw exception '${t.message}' in didMount`)}for(let t=e.subNodes.first;null!==t;t=t.next)this.postCreate(t)}preDestroy(e){for(let t=e.subNodes.first;null!==t;t=t.next)this.preDestroy(t);try{e.willUnmount()}catch(t){console.error(`Node ${e.name} threw exception '${t.message}' in willUnmount`)}}destroyPhysical(e){let t=e.getOwnDN();if(e.unmount(),t)t.remove();else for(let t=e.subNodes.last;null!==t;t=t.prev)this.destroyPhysical(t);e.terminate()}updateStemVirtual(e){let t=new a;return t.action=0,t.oldVN=e,this.updateVirtual(t),t}updateVirtual(e){let t=e.oldVN;if(this.currentVN=t,e.oldVN.supportsErrorHandling())try{this.updateSubNodesVirtual(e)}catch(t){e.oldVN.handleError(t,this.currentVN.path),this.updateSubNodesVirtual(e)}else this.updateSubNodesVirtual(e);e.oldVN.lastUpdateTick=this.currentTick,this.currentVN=t}updateSubNodesVirtual(e){this.buildNodeDisps(e);for(let t of e.subNodeDisps)2===t.action?(t.updateDisp=t.oldVN.prepareUpdate(t.newVN),t.updateDisp.shouldRender&&this.updateVirtual(t)):this.createVirtual(t.newVN,e.oldVN)}preUpdatePhysical(e){for(let t of e.subNodesToRemove)this.preDestroy(t);for(let t of e.subNodeDisps)this.preUpdatePhysical(t)}updatePhysical(e){let t=e.oldVN;for(let t of e.subNodesToRemove)this.destroyPhysical(t);t.subNodes.clear();let s=t.getOwnDN(),i=null!==s?s:t.anchorDN,r=null!==s?null:t.getNextDNUnderSameAnchorDN(i);for(let s=e.subNodeDisps.length-1;s>=0;s--){let n=e.subNodeDisps[s];if(2===n.action){let o=n.oldVN,l=n.newVN;n.updateDisp.shouldCommit&&o.commitUpdate(l);let u=o.getFirstDN();if(null!==u){let t=s===e.subNodeDisps.length-1?void 0:e.subNodeDisps[s+1];this.shouldMoveVN(n,t)&&u.nextSibling!==r&&i.insertBefore(u,r),r=u}n.updateDisp.shouldRender&&this.updatePhysical(n),t.subNodes.insertVN(o)}else{let e=n.newVN;this.createPhysical(e,i,r);let s=e.getFirstDN();null!==s&&(r=s),t.subNodes.insertVN(e)}}}postUpdate(e){for(let t of e.subNodeDisps)2===t.action?t.updateDisp.shouldRender&&this.postUpdate(t):1===t.action&&this.postCreate(t.newVN);try{e.oldVN.didUpdate()}catch(t){console.error(`Node ${e.oldVN.name} threw exception '${t.message}' in didUpdate`)}}buildNodeDisps(e){let t=v(e.oldVN.render()),s=new Map,i=[];for(let t=e.oldVN.subNodes.first;null!==t;t=t.next)void 0===t.key?i.push(t):s.set(t.key,t);let r=i.length,n=0;for(let o=t.first;null!==o;o=o.next){let t;void 0!==o.key?void 0!==(t=s.get(o.key))&&s.delete(o.key):n<r&&(t=i[n],n++);let l=new a;l.newVN=o,void 0===t?l.action=1:t.type===o.type&&t.isUpdatePossible(o)?(l.action=2,l.oldVN=t):(e.subNodesToRemove.push(t),l.action=1),e.subNodeDisps.push(l)}for(let t of s.values())e.subNodesToRemove.push(t);for(let t=n;t<r;t++)e.subNodesToRemove.push(i[t])}shouldMoveVN(e,t){return void 0===t?null!==e.oldVN.next:2!==t.action||e.oldVN.next!==t.oldVN}}u.mimblAnchorPropName="__mimblAnchorPropName__",t.RootVN=u;class h{constructor(){this.publishingVNs=new Set,this.subscribedVNs=new Set}}class a{constructor(){this.subNodeDisps=[],this.subNodesToRemove=[]}}const c=s(9),d=s(10),p=s(11),f=s(12),m=s(14);function v(e){const t=new n.VNChain;let s=typeof e;if(null==e||"boolean"===s||"function"===s)return t;if(e instanceof r.VN)t.appendVN(e);else if(e instanceof n.VNChain)t.appendChain(e);else if(e instanceof i.Component)t.appendVN(new c.InstanceVN(e));else if(Array.isArray(e))for(let s of e)t.appendChain(v(s));else if("string"===s)t.appendVN(new m.TextVN(e));else{if(e instanceof Promise)throw e;t.appendVN(new m.TextVN(e.toString()))}return t}t.createVNChainFromJSX=function(e,t,s){const r=new n.VNChain;if(e===i.Placeholder)r.appendChain(v(s));else if(i.Component.isPrototypeOf(e))r.appendVN(new d.ClassVN(e,t,s));else{let i=typeof e;"function"===i?r.appendVN(new p.FuncVN(e,t,s)):"string"===i&&r.appendVN(new f.ElmVN(e,t,s))}return r}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0);t.RootErrorUI=class extends i.Component{constructor(e,t,s){super(),this.onRestart=(()=>{this.rootVN.restart()}),this.rootVN=e,this.err=t,this.pathString=s?s.join(" → "):""}render(){return i.jsx("div",{id:"rootError",style:{display:"flex",flexDirection:"column",alignItems:"start"}},i.jsx("div",null,this.err.Message),i.jsx("div",null,this.pathString),i.jsx("hr",{style:{width:"100%"}}),i.jsx("button",{key:"btnRestart",click:this.onRestart},"Restart"))}};t.RootWaitingUI=class extends i.Component{render(){return"Loading ..."}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(5);t.InstanceVN=class extends i.CompBaseVN{constructor(e){super(1),this.comp=e,this.key=e,this.name=this.comp.constructor.name}get Comp(){return this.comp}willMount(){this.comp.setSite(this),this.comp.componentWillMount&&this.comp.componentWillMount()}willUnmount(){this.comp.componentWillUnmount&&this.comp.componentWillUnmount(),this.comp.setSite(null)}isUpdatePossible(e){return!0}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),r=s(5);t.ClassVN=class extends r.CompBaseVN{constructor(e,t,s){if(super(2),this.compClass=e,this.props={},t){for(let e in t){let s=t[e];null!=s&&("key"===e?this.key=s:"ref"===e?this.ref=s:this.props[e]=s)}void 0===this.key&&(this.key=t.id)}this.props.children=s,this.name=this.compClass.name,void 0!==this.key&&null!==this.key&&(this.name+=" @"+this.key)}get CompClass(){return this.compClass}get Comp(){return this.comp}willMount(){this.comp=new this.compClass(this.props),this.comp.setSite(this),this.comp.componentWillMount&&this.comp.componentWillMount(),void 0!==this.ref&&i.setRef(this.ref,this.comp)}willUnmount(){void 0!==this.ref&&i.setRef(this.ref,void 0,this.comp),this.comp.componentWillUnmount&&this.comp.componentWillUnmount(),this.comp.setSite(null),this.comp=void 0}isUpdatePossible(e){return this.compClass===e.compClass}prepareUpdate(e){let t=e,s=!0;return void 0!==this.comp.shouldComponentUpdate&&(s=this.comp.shouldComponentUpdate(t.props)),t.ref!==this.ref?(this.ref=t.ref,void 0!==this.ref&&i.setRef(this.ref,this.comp)):void 0===t.ref&&i.setRef(this.ref,void 0,this.comp),this.key=t.key,Object.keys(this.props).forEach(e=>delete this.props[e]),Object.assign(this.props,t.props),{shouldCommit:!1,shouldRender:s}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),r=s(1);t.FuncVN=class extends r.VN{static isVNaFragment(e){return e.func===i.Placeholder}constructor(e,t,s){if(super(3),this.func=e,this.props={},t){for(let e in t){let s=t[e];null!=s&&("key"===e?this.key=s:this.props[e]=s)}void 0===this.key&&(this.key=t.id)}this.props.children=s,this.name=this.func.name,void 0!==this.key&&null!==this.key&&(this.name+=" @"+this.key)}render(){return this.func(this.props)}isUpdatePossible(e){return this.func===e.func}prepareUpdate(e){let t=e;return this.key=t.key,this.props=t.props,{shouldCommit:!1,shouldRender:!0}}getOwnDN(){return null}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),r=s(1),n=s(2),o=s(13);function l(){try{let[e,...t]=arguments;return e(...t)}catch(e){let t=this.findService("StdErrorHandling");t&&t.reportError(e,this.path)}}t.ElmVN=class extends r.VN{constructor(e,t,s){super(4),this.elm=null,this.attrs={},this.events={},this.customAttrs={};let i=o.SvgElms.getSvgElmInfo(e);if(void 0!==i?(this.isSvg=!o.SvgElms.isDualPurpose(i)||void 0,this.elmName=o.SvgElms.getElmName(i,e)):(this.isSvg=!1,this.elmName=e),this.children=s,this.props={},t){for(let e in t){let s=t[e];null!=s&&("key"===e?this.key=s:"ref"===e?this.ref=s:this.props[e]=s)}void 0===this.key&&(this.key=t.id)}this.name=this.elmName,void 0!==this.key&&null!==this.key&&(this.name+="@"+this.key)}get ElmName(){return this.elmName}get Elm(){return this.elm}get IsSvg(){return this.isSvg}render(){return this.children}willMount(){if(void 0===this.isSvg){for(let e=this.parent;null!=e;e=e.parent)if(4===e.type&&"svg"===e.elmName){this.isSvg=!0;break}void 0===this.isSvg&&(this.isSvg=!1)}this.parseProps()}mount(){this.elm=this.isSvg?document.createElementNS(o.SvgElms.namespace,this.elmName):document.createElement(this.elmName),this.addAttrs(),this.addEvents(),this.addCustomAttrs(),void 0!==this.ref&&i.setRef(this.ref,this.elm)}unmount(){void 0!==this.ref&&i.setRef(this.ref,void 0,this.elm),this.removeCustomAttrs(),this.elm=null}isUpdatePossible(e){const t=e;return this.isSvg===t.isSvg&&this.elmName===t.elmName}prepareUpdate(e){const t=e;return this.props=t.props,this.children=t.children,{shouldCommit:!0,shouldRender:!0}}commitUpdate(e){const t=e;t.parseProps(),t.ref!==this.ref&&(this.ref=t.ref,void 0!==this.ref&&i.setRef(this.ref,this.elm)),this.key=t.key,this.updateAttrs(t.attrs),this.updateEvents(t.events),this.updateCustomAttrs(t.customAttrs)}getOwnDN(){return this.elm}parseProps(){if(this.props)for(let e in this.props){let t=this.props[e],s=n.ElmAttr.getPropertyInfo(e),i=s?s.type:0;if(s||(i=this.IsEventValue(t)?2:1),1===i)this.attrs[e]={info:s,val:t};else if(2===i){let i=this.GetPropAsEventRunTimeData(s,t);i&&(this.events[e]=i)}else this.customAttrs[e]={info:s,val:t,handler:void 0}}}IsEventValue(e){return"function"==typeof e||Array.isArray(e)&&e.length>0&&"function"==typeof e[0]}GetPropAsEventRunTimeData(e,t){if("function"==typeof t)return{info:e,orgFunc:t,useCapture:!1};if(Array.isArray(t)&&2===t.length&&"function"==typeof t[0]&&"boolean"==typeof t[1]){let s=t[0];return l.bind(this,s),{info:e,orgFunc:s,useCapture:t[1]}}}addAttrs(){let e=this.elm;for(let t in this.attrs){let s=this.attrs[t];n.ElmAttr.setAttr(e,t,s.info,s.val)}}updateAttrs(e){let t=this.elm,s=this.attrs;for(let i in s){let r=s[i],o=e[i];void 0===o||void 0===o.val?n.ElmAttr.removeAttr(t,i,r.info):n.ElmAttr.updateAttr(t,i,r.info,r.val,o.val)}for(let i in e){if(i in s)continue;let r=e[i];n.ElmAttr.setAttr(t,i,r.info,r.val)}this.attrs=e}addEvents(){for(let e in this.events)this.addEvent(e,this.events[e])}addEvent(e,t){t.wrapper=l.bind(this,t.orgFunc),this.elm.addEventListener(e,t.wrapper,t.useCapture)}removeEventListeners(){for(let e in this.events)this.removeEvent(e,this.events[e])}removeEvent(e,t){this.elm.removeEventListener(e,t.wrapper,t.useCapture)}updateEvents(e){let t=this.events;for(let s in t){let i=t[s],r=e[s];r?this.updateEvent(s,i,r):this.removeEvent(s,i)}for(let s in e){if(s in t)continue;let i=e[s];this.addEvent(s,i)}this.events=e}updateEvent(e,t,s){return t.orgFunc===s.orgFunc&&t.useCapture===s.useCapture?(s.wrapper=t.wrapper,!1):(this.elm.removeEventListener(e,t.wrapper,t.useCapture),s.wrapper=l.bind(this,s.orgFunc),this.elm.addEventListener(e,s.wrapper,s.useCapture),!0)}addCustomAttrs(){for(let e in this.customAttrs){let t=this.customAttrs[e],s=t.info.factory.createHandler(e);s?(s.initialize(this,e,t.val),t.handler=s):delete this.customAttrs[e]}}removeCustomAttrs(){for(let e in this.customAttrs)this.customAttrs[e].handler.terminate()}updateCustomAttrs(e){let t=this.customAttrs;for(let s in t){const i=t[s],r=e[s];null==r?i.handler.terminate():(i.handler.update(i.val,r.val),r.handler=i.handler)}for(let s in e){if(s in t)continue;let i=e[s],r=i.info.factory.createHandler(s);r&&(r.initialize(this,s,i.val),i.handler=r)}this.customAttrs=e}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{static register(e,t){i.infos[e]=t}static isSvgElm(e){return e in i.infos}static getSvgElmInfo(e){return i.infos[e]}static isDualPurpose(e){return Array.isArray(e)?e.length>1&&e[1]:"string"!=typeof e&&e}static isTagDualPurpose(e){let t=i.infos[e];return!!t&&i.isDualPurpose(t)}static getElmName(e,t){return Array.isArray(e)?e.length>0?e[0]:t:"string"==typeof e?e:t}static getElmNameForTag(e){let t=i.infos[e];return t?i.getElmName(t,e):e}}i.namespace="http://www.w3.org/2000/svg",i.infos={svg:!1,a:!0,animate:!1,animateMotion:!1,animateTransform:!1,circle:!1,clipPath:!1,colorProfile:"color-profile",defs:!1,desc:!1,discard:!1,ellipse:!1,feBlend:!1,feColorMatrix:!1,feComponentTransfer:!1,feComposite:!1,feConvolveMatrix:!1,feDiffuseLighting:!1,feDisplacementMap:!1,feDistantLight:!1,feDropShadow:!1,feFlood:!1,feFuncA:!1,feFuncB:!1,feFuncG:!1,feFuncR:!1,feGaussianBlur:!1,feImage:!1,feMerge:!1,feMergeNode:!1,feMorphology:!1,feOffset:!1,fePointLight:!1,feSpecularLighting:!1,feSpotLight:!1,feTile:!1,feTurbulence:!1,filter:!1,foreignObject:!1,g:!1,hatch:!1,hatchpath:!1,image:!1,line:!1,linearGradient:!1,marker:!1,mask:!1,metadata:!1,mpath:!1,path:!1,pattern:!1,polygon:!1,polyline:!1,radialGradient:!1,rect:!1,script:!0,set:!1,solidcolor:!1,stop:!1,style:!0,switch:!1,symbol:!1,text:!1,textPath:!1,title:!0,textSpan:!1,use:!1,view:!1},t.SvgElms=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(1);t.TextVN=class extends i.VN{constructor(e){super(5),this.text=e,this.name="#text"}get Text(){return this.text}get TextNode(){return this.dn}mount(){this.dn=document.createTextNode(this.text)}unmount(){this.dn=void 0}isUpdatePossible(e){return!0}prepareUpdate(e){return{shouldCommit:this.text!==e.text,shouldRender:!1}}commitUpdate(e){this.text=e.text,this.dn.nodeValue=this.text}getOwnDN(){return this.dn}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{static MergeClasses(...e){let t;for(let s of e){if(!s)continue;void 0===t?t="":t+=" ",t+="string"==typeof s?s:i.ArrayToString(s)}return t}static ArrayToString(e){return e.join(" ")}}t.Classes=i;class r{static MergeStyles(...e){let t={};return r.MergeStylesTo(t,...e),t}static MergeStylesTo(e,...t){for(let s of t){if(!s)continue;let t="object"==typeof s?s:r.ParseStyleString(s);for(let s in t)e[s]=t[s]}}static ParseStyleString(e){if(!e)return{};let t={},s=e.split(";");for(let e of s){let s=e.split(":");!s||0===s.length||s.length>2||(t[r.DashToCamel(s[0].trim())]=s[1].trim())}return t}static DashToCamel(e){if(!e)return e;let t,s=-1,i=0;for(;(s=e.indexOf("-",s+1))>=0;)void 0===t&&(t=""),t+=e.substr(i,s-i),s!=e.length-1&&(t+=e[s+1].toUpperCase()),i=s+2;return void 0===t?e:(i<e.length&&(t+=e.substr(i)),t)}}t.Styles=r;class n{static MergeSlices(...e){let t={};return n.MergeSlicesTo(t,...e),t}static MergeSlicesTo(e,...t){if(null!=e)for(let s of t)if(s){if(s.style&&(void 0===e.style&&(e.style={}),r.MergeStylesTo(e.style,s.style)),s.className&&(void 0===e.className&&(e.className=""),e.className=i.MergeClasses(e.className,s.className)),s.props){void 0===e.props&&(e.props={});for(let t in s.props)e[t]=s[t]}if(s.content)if(void 0===e.content)e.content=s.content;else{if(!Array.isArray(e.content)){let t=e.content;e.content=[],e.content.push(t)}e.content.push(s.content)}}}}t.Slices=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0);t.ComponentWithLocalStyles=class extends i.Component{constructor(e=null){super(e),this.m_uniqueID=Math.floor(1e9*Math.random()).toString(),this.rules=new Map,this.ruleNames=[],this.styleElm=document.createElement("style"),this.styleElm.id=this.m_uniqueID,document.head.appendChild(this.styleElm)}get uniqueID(){return this.m_uniqueID}decorateName(e){return e+this.m_uniqueID}createStyleRule(e,t,s){let i=this.createDummyRule(e,"dummy {}"),r=i.cssomRule,o=new n(this.uniqueID,r);return t&&o.setSelector(t),s&&o.setProperties(s),i.mcssRule=o,o}getRule(e){let t=this.rules.get(e);return void 0===t?void 0:t.mcssRule}removeRule(e){}componentDidMount(){this.site.publishService("LocalStyles",this)}componentWillUnmount(){this.site.unpublishService("LocalStyles"),this.styleElm.remove()}createDummyRule(e,t){let s=this.rules.get(e);void 0!==s&&this.removeRule(e);let i=this.ruleNames.length,r=this.styleElm.sheet;r.insertRule(t,i);let n=r.rules[i];return this.ruleNames.push(e),s={mcssRule:null,cssomRule:n,index:i},this.rules.set(e,s),s}};class r{constructor(e,t){this.uniqueID=e,this.cssomRule=t}decorate(e){return e+this.uniqueID}replace(e){return e.replace("(*)",this.uniqueID)}}class n extends r{constructor(e,t){super(e,t)}setSelector(e){this.cssomRule.selectorText=this.replace(e)}setProperty(e,t,s){this.cssomRule.style.setProperty(this.replace(e),this.replace(t),s?"important":void 0)}setProperties(e){if(e)for(let t in e)this.cssomRule.style[this.replace(t)]=this.replace(e[t])}removeProperty(e){this.cssomRule.style.removeProperty(this.replace(e))}}},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))(function(r,n){function o(e){try{u(i.next(e))}catch(e){n(e)}}function l(e){try{u(i.throw(e))}catch(e){n(e)}}function u(e){e.done?r(e.value):new s(function(t){t(e.value)}).then(o,l)}u((i=i.apply(e,t||[])).next())})},r=this&&this.__rest||function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&(s[i[r]]=e[i[r]])}return s};Object.defineProperty(t,"__esModule",{value:!0});const n=s(18),o=s(0);class l extends o.Component{constructor(e){if(super(),this.onPopstate=(e=>{let t=e.state;t&&(t.routeID?this.navigateByID(t.routeID,t.fields):t.routeURL?this.navigateByURL(t.routeURL):console.log("Route state in popstate event has neither route ID nor path."))}),this.routes=[],this.routesByID=new Map,this.error=null,this.errorPath=null,this.props=e,this.props.children)for(let e of this.props.children)this.addRoute(e)}addRoute(e,t){if(!e)throw new Error("Route object cannot be null");void 0!==t?this.routes.splice(t,0,e):this.routes.push(e),this.addRouteToMap(e)}removeRoute(e){let t=this.routes.splice(e,1)[0];return this.removeRouteFromMap(t),t}addRouteToMap(e){if(e.id&&this.routesByID.set(e.id,e),e.subRoutes)for(let t of e.subRoutes)this.addRouteToMap(t)}removeRouteFromMap(e){if(e.id&&this.routesByID.delete(e.id),e.subRoutes)for(let t of e.subRoutes)this.removeRouteFromMap(t)}navigateByURL(e,t=!1){let[s,i]=this.findRouteByURL(e);s?this.navigateToRoute(s,e,i,t):this.higherRouterService&&this.higherRouterService.r.navigateByURL(e,t)}navigateByID(e,t,s){let i,r=this.routesByID.get(e);r?(this.controlsBrowser&&(i=r.urlPattern),this.navigateToRoute(r,i,t,s)):this.higherRouterService&&this.higherRouterService.r.navigateByID(e,t)}findRouteByURL(e){return l.findRouteRecursiveByURL(e,this.routes)}static findRouteRecursiveByURL(e,t){for(let s of t){let t=n.match(e,s.urlPattern);if(t)return[s,t.fields];if(s.subRoutes){let t=l.findRouteRecursiveByURL(e,s.subRoutes);if(t[0])return t}}return[null,null]}navigateToRoute(e,t,s,r){return i(this,void 0,void 0,function*(){if(this.currRoute&&this.currRoute.navFromFunc){let e=this.currRoute.navFromFunc();if(e instanceof Promise&&(e=yield e),!e)return}if(this.controlsBrowser&&r){let i={routeID:e.id,routeURL:t,fields:s};history.pushState(i,"",t)}this.currRoute=e;let i=e.navToFunc?e.navToFunc(s):null;i instanceof Promise?this.currRouteContent=yield i:this.currRouteContent=i,this.updateMe()})}reportError(e,t){this.handleError(e,t),this.updateMe()}componentWillMount(){this.site.publishService("StdErrorHandling",this),this.site.publishService("Router",this),this.chainsToHigherRouter&&(this.higherRouterService=new o.Ref,this.site.subscribeService("Router",this.higherRouterService,void 0,!1));let e=this.routes.length>0?this.routes[0]:null;if(!e)return;this.currRoute=e;let t=e.navToFunc?e.navToFunc({}):null;if(t instanceof Promise?(this.currRouteContent="Please wait while content is loading...",t.then(e=>{this.currRouteContent=e,this.updateMe})):this.currRouteContent=t,this.controlsBrowser){this.baseURL,window.addEventListener("popstate",this.onPopstate);let t={routeID:e.id,routeURL:e.urlPattern,fields:null};history.replaceState(t,"",e.urlPattern)}}componentWillUnmount(){this.controlsBrowser&&window.removeEventListener("popstate",this.onPopstate),this.chainsToHigherRouter&&(this.site.unsubscribeService("Router"),this.higherRouterService=void 0),this.site.unpublishService("Router"),this.site.unpublishService("StdErrorHandling")}render(){return this.virtRender(this.currRouteContent)}handleError(e,t){this.currRouteContent=o.jsx("div",{id:"rootError",style:{backgroundColor:"pink",display:"flex",flexDirection:"column",alignItems:"start"}},e,t&&t.map(e=>o.jsx("span",null,e)))}virtRender(e){return e}get controlsBrowser(){return void 0===this.props.controlsBrowser||this.props.controlsBrowser}get chainsToHigherRouter(){return void 0===this.props.chainsToHigherRouter||this.props.chainsToHigherRouter}get baseURL(){return void 0===this.props.baseURL?"":this.props.baseURL}set OuterContentFunc(e){this.outerContentFunc=e}set ProgressContentFunc(e){this.progressContentFunc=e}}t.Router=l;t.Link=class extends o.Component{constructor(e){super(e),this.onClick=(e=>{e.preventDefault();let t=this.site.getService("Router");t&&(this.props.routeID?t.navigateByID(this.props.routeID,this.props.fields,this.props.makeHistoryEntry):t.navigateByURL(this.props.routeURL,this.props.makeHistoryEntry))}),this.routerService=new o.Ref}render(){let e=this.props,{routeURL:t,routeID:s,fields:i,makeHistoryEntry:n}=e,l=r(e,["routeURL","routeID","fields","makeHistoryEntry"]);return o.jsx("a",Object.assign({href:"#",click:this.onClick},l),this.props.children)}}},function(t,s){t.exports=e}])});
//# sourceMappingURL=mimbl.js.map
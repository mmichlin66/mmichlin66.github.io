!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("mimbl"),require("mimurl")):"function"==typeof define&&define.amd?define(["mimbl","mimurl"],t):"object"==typeof exports?exports.mimcl=t(require("mimbl"),require("mimurl")):e.mimcl=t(e.mimbl,e.mimurl)}(this,function(e,t){return function(e){var t={};function s(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(i,r,function(t){return e[t]}.bind(null,r));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=7)}([function(t,s){t.exports=e},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DNDTYPE_ELEMENT="application/DOMElement"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0);class r extends i.Component{constructor(e){super(),this.onKeyDown=e=>{27===e.keyCode&&e.preventDefault()},this.onMove=e=>{this.move(e.clientX-this.dragPointOffsetX,e.clientY-this.dragPointOffsetY)},this.onStopMove=e=>{window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onStopMove)},this.caption=new i.Ref,this.dlgSlice=e||{},r.DefaultDlgSlice||(r.DefaultDlgSlice={style:{borderStyle:"solid",borderWidth:"1px",padding:"0"}})}open(e,t){if(this.isOpen())return!1;this.create(e,t),this.dlg.show()}close(e){this.dlg.close(),this.destroy(),this.modalPromiseResolveFunc&&(this.modalPromiseResolveFunc(e),this.modalPromiseResolveFunc=void 0)}showModal(e,t){if(this.isOpen())return Promise.reject("Dialog is already open");let s=new Promise(e=>{this.modalPromiseResolveFunc=e});return this.create(e,t),this.dlg.showModal(),s}isOpen(){return void 0!==this.dlg}isModeless(){return this.isOpen()&&void 0===this.modalPromiseResolveFunc}isModal(){return this.isOpen()&&void 0!==this.modalPromiseResolveFunc}startMove(e){e.preventDefault(),e.stopPropagation();let t=this.dlg.getBoundingClientRect();this.dragPointOffsetX=e.clientX-t.left,this.dragPointOffsetY=e.clientY-t.top,this.dlg.style.margin=this.currDlgSlice.style.margin="0",this.dlg.style.top=this.currDlgSlice.style.top=t.top+"px",this.dlg.style.left=this.currDlgSlice.style.left=t.left+"px",window.addEventListener("mousemove",this.onMove),window.addEventListener("mouseup",this.onStopMove)}move(e,t){e<0?e=0:e+30>window.innerWidth&&(e=window.innerWidth-30),t<0?t=0:t+30>window.innerHeight&&(t=window.innerHeight-30),this.dlg.style.left=this.currDlgSlice.style.left=e+"px",this.dlg.style.top=this.currDlgSlice.style.top=t+"px"}render(){return i.jsx("dialog",Object.assign({ref:e=>this.dlg=e,style:this.currDlgSlice.style,class:this.currDlgSlice.className},this.currDlgSlice.props),this.currDlgSlice.content)}getDlgSlice(){return this.dlgSlice}create(e,t){let s={position:"fixed"};void 0===e?(s.left="0px",s.right="0px"):(s.left=e+"px",s.marginLeft="0",s.marginRight="0"),void 0===t?(s.top="0px",s.bottom="0px"):(s.top=t+"px",s.marginTop="0",s.marginBottom="0"),this.currDlgSlice=i.Slices.MergeSlices(r.DefaultDlgSlice,this.getDlgSlice(),{style:s}),this.anchorDiv=document.createElement("div"),document.body.appendChild(this.anchorDiv),i.mountSync(this,this.anchorDiv),window.addEventListener("keydown",this.onKeyDown)}destroy(){window.removeEventListener("keydown",this.onKeyDown),i.unmountSync(this.anchorDiv),this.anchorDiv.remove()}get DlgSlice(){return this.DlgSlice}}t.Popup=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),r=s(2);class o extends r.Popup{constructor(e,t,s,i){super(i),this.onStartMove=e=>{this.startMove(e)},this.buttonInfos=[],this.captionAreaSlice=e||{},this.mainAreaSlice=t||{},this.buttonAreaSlice=s||{},o.DefaultCaptionAreaSlice||(o.DefaultCaptionAreaSlice={style:{background:"pink",padding:"0.5em 1em",cursor:"default"}}),o.DefaultMainAreaSlice||(o.DefaultMainAreaSlice={style:{padding:"0.5em 1em"}}),o.DefaultButtonAreaSlice||(o.DefaultButtonAreaSlice={style:{display:"flex",justifyContent:"flex-end",padding:"0.5em 1em"}}),o.DefaultButtonSlice||(o.DefaultButtonSlice={style:{marginLeft:"0.5em",minWidth:"5em"}})}addButton(e,t,s,r){let o={slice:e,key:t,callback:s,ref:new i.Ref};void 0===r?this.buttonInfos.push(o):0===r?this.buttonInfos.unshift(o):this.buttonInfos.splice(r-1,0,o),this.buttonAreaProxy&&this.buttonAreaProxy.update()}removeButton(e){this.buttonInfos.splice(e,1),this.buttonAreaProxy&&this.buttonAreaProxy.update()}getDlgSlice(){return this.captionAreaProxy=new i.FuncProxy(()=>{let e=i.Slices.MergeSlices(o.DefaultCaptionAreaSlice,this.getCaptionAreaSlice());return i.jsx("div",Object.assign({id:"dlgCaption",mousedown:this.onStartMove,style:e.style,class:e.className},e.props),e.content)}),this.mainAreaProxy=new i.FuncProxy(()=>{let e=i.Slices.MergeSlices(o.DefaultMainAreaSlice,this.getMainAreaSlice());return i.jsx("div",Object.assign({id:"dlgMainContent",style:e.style,class:e.className},e.props),e.content)}),this.buttonAreaProxy=new i.FuncProxy(()=>{let e=i.Slices.MergeSlices(o.DefaultButtonAreaSlice,this.getButtonAreaSlice());return i.jsx("div",Object.assign({id:"dlgButtons",style:e.style,class:e.className},e.props),e.content,this.buttonInfos.map(e=>{let t=i.Slices.MergeSlices(o.DefaultButtonSlice,e.slice);return i.jsx("button",Object.assign({key:e.key,click:e.callback&&(()=>e.callback(e.key)),style:t.style,class:t.className},t.props),t.content)}))}),{content:i.jsx(i.Fragment,null,this.captionAreaProxy,this.mainAreaProxy,this.buttonAreaProxy)}}getCaptionAreaSlice(){return this.captionAreaSlice}getMainAreaSlice(){return this.mainAreaSlice}getButtonAreaSlice(){return this.buttonAreaSlice}get CaptionAreaSlice(){return this.captionAreaSlice}set CaptionAreaSlice(e){this.captionAreaSlice=e}get MainAreaSlice(){return this.mainAreaSlice}set MainAreaSlice(e){this.mainAreaSlice=e}get ButtonAreaSlice(){return this.buttonAreaSlice}set ButtonAreaSlice(e){this.buttonAreaSlice=e}}t.Dialog=o,function(e){e[e.None=0]="None",e[e.OK=1]="OK",e[e.Cancel=2]="Cancel",e[e.Yes=4]="Yes",e[e.No=8]="No",e[e.Close=16]="Close"}(t.DialogButton||(t.DialogButton={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0);t.TreeNodeContainer=class extends i.Component{constructor(e){super(),this.nodes=[],this.nodeFactory=e}addNode(e,t){let s=this.nodes.length,i=this.nodeFactory();if(null==t||t<0||t>=s)i.index=s,this.nodes.push(i);else{i.index=t,this.nodes.splice(t,0,i);for(let e=t+1;e<s;e++)this[e].index=e}return i.content=e.content,i.icon=e.icon,i.textColor=e.textColor,i.bgColor=e.bgColor,i.italic=e.italic,i.bold=e.bold,i.customClass=e.customClass,i.data=e.data,this.updateMe(),i}removeNode(e){let t=this.nodes.length;if(e<0||e>=t)throw new Error("replaceNode: invalid index "+e);this.nodes.splice(e,1);for(let s=e;s<t;s++)this[s].index=s;this.updateMe()}removeAllNodes(){let e=this.nodes.length;e>0&&(this.nodes.splice(0,e),this.updateMe())}expandAll(){for(let e of this.nodes)e.expandAll()}collapseAll(){for(let e of this.nodes)e.collapseAll()}render(){return this.nodes}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ScrollAxis=class{constructor(e,t,s){this.minOverscan=e,this.optOverscan=t,this.maxOverscan=s}measure(e,t,s,r,o,n,a,l){let h=new i;if(0===e)return h;if(0===s)throw new Error("itemCount cannot be zero");let c=t+s-1,d=e-1,u=a/s;r&&(u=(u+r)/2);let p,g,m=Math.min(Math.floor(l/u),d),f=Math.min(Math.ceil((l+o)/u),d),v=Math.max(m-this.minOverscan,0),D=Math.max(m-this.optOverscan,0),E=Math.max(m-this.maxOverscan,0),w=Math.min(f+this.minOverscan,d),b=Math.min(f+this.optOverscan,d),y=Math.min(f+this.maxOverscan,d);return(p=v<t?D:v>t&&v<c?Math.max(E,t):E>c?D:c-E>D-c?E:D)>(g=w>c?b:w<c&&w>t?Math.min(y,c):y<t?b:y-t>t-b?y:b)&&console.error(`Wrong ScrollAxis calculation: newFirst '${p}' is greater than newLast '${g}'`),h.newFirst=p,h.newLast=g,h.newAvgItemSize=u,h.newWallSize=Math.ceil(e*u),h.newSubsetOffset=Math.ceil(p*u),p==t&&g==c?h.noAddRemoveNeeded=!0:p>c||g<t?h.neeedToRemoveAllItems=!0:(p<t?h.countToAddAtStart=t-p:p>t&&(h.countToRemoveAtStart=p-t),g<c?h.countToRemoveAtEnd=c-g:g>c&&(h.countToAddAtEnd=g-c)),h}};class i{constructor(){this.newAvgItemSize=0,this.newWallSize=0,this.newSubsetOffset=0,this.newFirst=0,this.newLast=0,this.noAddRemoveNeeded=!1,this.neeedToRemoveAllItems=!1,this.countToRemoveAtStart=0,this.countToRemoveAtEnd=0,this.countToAddAtStart=0,this.countToAddAtEnd=0}}t.ScrollAxisAction=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{static setObjectData(e,t){e&&void 0!==t&&i.dataMap.set(e,t)}static getObjectData(e){return i.dataMap.get(e)}static removeObjectData(e){i.dataMap.delete(e)}static clearAllObjectData(){i.dataMap.clear()}static hasType(e,t){return e.types.indexOf?e.types.indexOf(t)>=0:e.types.contains(t)}}i.dataMap=new Map,t.DragAndDropData=i;t.EmulDataTransfer=class extends DataTransfer{constructor(){super(),this.isImageElmReset=!1,this.dataMap=new Map,this.dataFormats=[]}setDragImage(e,t,s){this.imageElm=e,this.imageElmX=t,this.imageElmY=s,super.setDragImage&&super.setDragImage(e,t,s),this.isImageElmReset=!0}set effectAllowed(e){this.effectAllowedEx=e,super.effectAllowed=e}get effectAllowed(){return void 0===this.effectAllowedEx?super.effectAllowed:this.effectAllowedEx}set dropEffect(e){this.dropEffectEx=e,super.dropEffect=e}get dropEffect(){return void 0===this.dropEffectEx?super.dropEffect:this.dropEffectEx}setData(e,t){return super.setData(e,t),this.dataMap.set(e,t),this.dataFormats=Array.from(this.dataMap.keys()),!0}getData(e){let t=this.dataMap.get(e);return void 0===t?"":t}clearData(e){return super.clearData(e),e?this.dataMap.delete(e):this.dataMap.clear(),this.dataFormats=Array.from(this.dataMap.keys()),!0}get types(){return this.dataFormats}};t.EmulLegacyDataTransfer=class extends DataTransfer{constructor(){super(),this.isImageElmReset=!1,this.dataMap=new Map,this.dataFormats=[],this.m_items=null,this.m_files=null}setDragImage(e,t,s){this.imageElm=e,this.imageElmX=t,this.imageElmY=s,this.isImageElmReset=!0}set effectAllowed(e){this.effectAllowedEx=e}get effectAllowed(){return this.effectAllowedEx}set dropEffect(e){this.dropEffectEx=e}get dropEffect(){return this.dropEffectEx}setData(e,t){return this.dataMap.set(e,t),this.dataFormats=Array.from(this.dataMap.keys()),!0}getData(e){let t=this.dataMap.get(e);return void 0===t?"":t}clearData(e){return e?this.dataMap.delete(e):this.dataMap.clear(),this.dataFormats=Array.from(this.dataMap.keys()),!0}get types(){return this.dataFormats}get files(){return this.m_files}get items(){return this.m_items}}},function(e,t,s){"use strict";function i(e){for(var s in e)t.hasOwnProperty(s)||(t[s]=e[s])}Object.defineProperty(t,"__esModule",{value:!0}),i(s(1)),i(s(2)),i(s(3)),i(s(8)),i(s(9)),i(s(11)),i(s(5)),i(s(14)),s(15).registerDragDropCustomAttributes()},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),r=s(3);class o extends r.Dialog{constructor(e,t,s=n.OK,i=a.None){super(),this.onButtonClicked=e=>{this.close(e)},this.message=e,this.title=t,this.buttons=s,this.icon=i,this.createButtons()}static showModal(e,t,s=n.OK,i=a.None){return new o(e,t,s,i).showModal()}getCaptionAreaSlice(){return{content:this.title,style:{backgroundColor:"DodgerBlue"}}}getMainAreaSlice(){let{cls:e,color:t}=this.getIconClassAndColor();return{content:i.jsx("div",{style:{display:"flex",alignItems:"start"}},e&&i.jsx("i",{class:"fa fa-3x "+e,style:{color:t}}),i.jsx("div",{style:{marginLeft:"10px",minWidth:"15em",maxWidth:"40em",minHeight:"2em",maxHeight:"20em",overflow:"auto"}},this.message))}}createButtons(){switch(this.buttons){case n.Close:this.createButton("Close",r.DialogButton.Close);break;case n.OK:this.createButton("OK",r.DialogButton.OK);break;case n.OkCancel:this.createButton("OK",r.DialogButton.OK),this.createButton("Cancel",r.DialogButton.Cancel);break;case n.YesNo:this.createButton("Yes",r.DialogButton.Yes),this.createButton("No",r.DialogButton.No);break;case n.YesNoCancel:this.createButton("Yes",r.DialogButton.Yes),this.createButton("No",r.DialogButton.No),this.createButton("Cancel",r.DialogButton.Cancel)}}getIconClassAndColor(){switch(this.icon){case a.Info:return{cls:"fa-info-circle",color:"blue"};case a.Warning:return{cls:"fa-exclamation-triangle",color:"orange"};case a.Error:return{cls:"fa-minus-circle",color:"red"};case a.Question:return{cls:"fa-question-circle",color:"green"};default:return{cls:"",color:""}}}createButton(e,t){this.addButton({content:e},t,this.onButtonClicked)}}var n,a;t.MsgBox=o,function(e){e[e.None=0]="None",e[e.Close=1]="Close",e[e.OK=2]="OK",e[e.OkCancel=3]="OkCancel",e[e.YesNo=4]="YesNo",e[e.YesNoCancel=5]="YesNoCancel"}(n=t.MsgBoxButtons||(t.MsgBoxButtons={})),function(e){e[e.None=0]="None",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Question=4]="Question"}(a=t.MsgBoxIcon||(t.MsgBoxIcon={}))},function(e,t,s){"use strict";var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))(function(r,o){function n(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){e.done?r(e.value):new s(function(t){t(e.value)}).then(n,a)}l((i=i.apply(e,t||[])).next())})},r=this&&this.__rest||function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(s[i[r]]=e[i[r]])}return s};Object.defineProperty(t,"__esModule",{value:!0});const o=s(10),n=s(0);class a extends n.Component{constructor(e){if(super(),this.onPopstate=e=>{let t=e.state;t&&(t.routeID?this.navigateByID(t.routeID,t.fields):t.routeURL?this.navigateByURL(t.routeURL):console.log("Route state in popstate event has neither route ID nor path."))},this.routes=[],this.routesByID=new Map,this.error=null,this.errorPath=null,this.props=e,this.props.children)for(let e of this.props.children)this.addRoute(e)}addRoute(e,t){if(!e)throw new Error("Route object cannot be null");void 0!==t?this.routes.splice(t,0,e):this.routes.push(e),this.addRouteToMap(e)}removeRoute(e){let t=this.routes.splice(e,1)[0];return this.removeRouteFromMap(t),t}addRouteToMap(e){if(e.id&&this.routesByID.set(e.id,e),e.subRoutes)for(let t of e.subRoutes)this.addRouteToMap(t)}removeRouteFromMap(e){if(e.id&&this.routesByID.delete(e.id),e.subRoutes)for(let t of e.subRoutes)this.removeRouteFromMap(t)}navigateByURL(e,t=!1){let[s,i]=this.findRouteByURL(e);s?this.navigateToRoute(s,e,i,t):this.higherRouterService&&this.higherRouterService.r.navigateByURL(e,t)}navigateByID(e,t,s){let i,r=this.routesByID.get(e);r?(this.controlsBrowser&&(i=r.urlPattern),this.navigateToRoute(r,i,t,s)):this.higherRouterService&&this.higherRouterService.r.navigateByID(e,t)}findRouteByURL(e){return a.findRouteRecursiveByURL(e,this.routes)}static findRouteRecursiveByURL(e,t){for(let s of t){let t=o.match(e,s.urlPattern);if(t&&t.success)return[s,t.fields];if(s.subRoutes){let t=a.findRouteRecursiveByURL(e,s.subRoutes);if(t[0])return t}}return[null,null]}navigateToRoute(e,t,s,r){return i(this,void 0,void 0,function*(){if(this.currRoute&&this.currRoute.navFromFunc){let e=this.currRoute.navFromFunc();if(e instanceof Promise&&(e=yield e),!e)return}if(this.controlsBrowser&&r){let i={routeID:e.id,routeURL:t,fields:s};history.pushState(i,"",t)}this.currRoute=e;let i=e.navToFunc?e.navToFunc(s):null;i instanceof Promise?this.currRouteContent=yield i:this.currRouteContent=i,this.updateMe()})}reportError(e,t){this.handleError(e,t),this.updateMe()}willMount(){this.vn.publishService("StdErrorHandling",this),this.vn.publishService("Router",this),this.chainsToHigherRouter&&(this.higherRouterService=new n.Ref,this.vn.subscribeService("Router",this.higherRouterService,void 0,!1));let e=this.routes.length>0?this.routes[0]:null;if(!e)return;this.currRoute=e;let t=e.navToFunc?e.navToFunc({}):null;if(t instanceof Promise?(this.currRouteContent="Please wait while content is loading...",t.then(e=>{this.currRouteContent=e,this.updateMe})):this.currRouteContent=t,this.controlsBrowser){this.baseURL,window.addEventListener("popstate",this.onPopstate);let t={routeID:e.id,routeURL:e.urlPattern,fields:null};history.replaceState(t,"",e.urlPattern)}}willUnmount(){this.controlsBrowser&&window.removeEventListener("popstate",this.onPopstate),this.chainsToHigherRouter&&(this.vn.unsubscribeService("Router"),this.higherRouterService=void 0),this.vn.unpublishService("Router"),this.vn.unpublishService("StdErrorHandling")}render(){return this.virtRender(this.currRouteContent)}handleError(e,t){this.currRouteContent=n.jsx("div",{id:"rootError",style:{backgroundColor:"pink",display:"flex",flexDirection:"column",alignItems:"start"}},e,t&&t.map(e=>n.jsx("span",null,e)))}virtRender(e){return e}get controlsBrowser(){return void 0===this.props.controlsBrowser||this.props.controlsBrowser}get chainsToHigherRouter(){return void 0===this.props.chainsToHigherRouter||this.props.chainsToHigherRouter}get baseURL(){return void 0===this.props.baseURL?"":this.props.baseURL}set OuterContentFunc(e){this.outerContentFunc=e}set ProgressContentFunc(e){this.progressContentFunc=e}}t.Router=a;t.Link=class extends n.Component{constructor(e){super(e),this.onClick=e=>{e.preventDefault();let t=this.vn.getService("Router");t&&(this.props.routeID?t.navigateByID(this.props.routeID,this.props.fields,this.props.makeHistoryEntry):t.navigateByURL(this.props.routeURL,this.props.makeHistoryEntry))},this.routerService=new n.Ref}render(){let e=this.props,{routeURL:t,routeID:s,fields:i,makeHistoryEntry:o}=e,a=r(e,["routeURL","routeID","fields","makeHistoryEntry"]);return n.jsx("a",Object.assign({href:"#",click:this.onClick},a),this.props.children)}}},function(e,s){e.exports=t},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(12);t.createTree=function(){return new i.Tree}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),r=s(4),o=s(13);t.Tree=class extends i.ComponentWithLocalStyles{constructor(){super(),this.onKeyDown=e=>{e.preventDefault(),"ArrowDown"===e.key?this.selectDown(this.m_selectedNode):"ArrowUp"===e.key?this.selectUp(this.m_selectedNode):"ArrowRight"===e.key?this.expandOrSelectDown(this.m_selectedNode):"ArrowLeft"===e.key&&this.collapseOrSelectUp(this.m_selectedNode)},this.m_selectedNode=null,this.tabIndex=0,this.container=new r.TreeNodeContainer(()=>new o.TreeNode(null,0,this)),this.elmRef=new i.Ref,this.prepareLocalStyles()}get tabIndex(){return this.m_tabIndex}set tabIndex(e){this.m_tabIndex=e,this.updateMe()}get nodes(){return this.container.nodes}addNode(e,t){let s=this.container.addNode(e,t);return this.updateMe(),s}removeNode(e){this.container.removeNode(e),this.updateMe()}removeAllNodes(){this.container.removeAllNodes(),this.updateMe()}expandAll(){this.container.expandAll()}collapseAll(){this.container.collapseAll()}get selectedNode(){return this.m_selectedNode}render(){return i.jsx("div",{ref:this.elmRef,tabindex:this.tabIndex,class:this.cssClassTree,keydown:this.onKeyDown},this.container)}selectDown(e){let t=this.findDown(e);t&&(t.select(),t.scrollIntoView(!1))}selectUp(e){let t=this.findUp(e);t&&(t.select(),t.scrollIntoView(!0))}expandOrSelectDown(e){if(e)if(e.container.nodes.length>0)if(e.m_isExpanded){let t=e.container.nodes[0];t.select(),t.scrollIntoView(!1)}else e.expand();else this.selectDown(e)}collapseOrSelectUp(e){e&&(e.m_isExpanded?e.collapse():this.selectUp(e))}findDown(e,t=!1){if(e)if(t){let t=e.m_parent?e.m_parent.container:this.container;if(e.index<t.nodes.length-1)return t.nodes[e.index+1];if(e.m_parent)return this.findDown(e.m_parent,!0)}else{if(!(e.isExpanded&&e.container.nodes.length>0))return this.findDown(e,!0);e.container.nodes[0].select()}else if(this.container.nodes.length>0)return this.container.nodes[0];return null}findUp(e){if(e){if(0!==e.index){let t=(e.m_parent?e.m_parent.container:this.container).nodes[e.index-1],s=this.findLastExpandedNode(t);return s||t}if(e.m_parent)return e.m_parent}else if(this.container.nodes.length>0)return this.container.nodes[0];return null}findLastExpandedNode(e){if(!e||0===e.container.nodes.length||!e.m_isExpanded)return null;let t=e.container.nodes[e.container.nodes.length-1],s=this.findLastExpandedNode(t);return s||t}prepareLocalStyles(){this.cssClassTree=this.decorateName("tree"),this.cssRuleTree=this.createStyleRule("tree",".tree(*)",{cursor:"default",border:"1px solid DodgerBlue",fontFamily:"Verdana, Geneva, Tahoma, sans-serif",fontSize:"12px",boxSizing:"border-box",maxHeight:"100%",overflow:"auto"}),this.cssClassNode=this.decorateName("tree-node"),this.cssRuleNode=this.createStyleRule("tree-node",".tree-node(*)",{display:"flex",alignItems:"center"}),this.cssClassNodeContent=this.decorateName("tree-node-content"),this.cssRuleNodeContent=this.createStyleRule("tree-node-content",".tree-node-content(*)",{marginLeft:"2px",padding:"1px"}),this.cssRuleNodeContentHover=this.createStyleRule("tree-node-content:hover",".tree-node-content(*):hover",{backgroundColor:"lightcyan"}),this.cssClassNodeContentSelected=this.decorateName("tree-node-content-selected"),this.cssRuleNodeContentSelected=this.createStyleRule("tree-node-content-selected",".tree-node-content-selected(*)",{marginLeft:"2px",border:"1px dotted",backgroundColor:"DodgerBlue",color:"white"}),this.cssClassNodeIcon=this.decorateName("tree-node-icon"),this.cssRuleNodeIcon=this.createStyleRule("tree-node-icon",".tree-node-icon(*)",{fontSize:"10px",width:"1em",height:"1em"}),this.cssClassSubnodes=this.decorateName("tree-subnodes"),this.cssRuleSubNodes=this.createStyleRule("tree-subnodes",".tree-subnodes(*)",{marginLeft:"16px"})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),r=s(4);class o extends i.Component{constructor(e,t,s=null){super(),this.nodeFactory=()=>new o(this,this.m_level+1),this.onClick=e=>{this.select()},this.onDblClick=e=>{e.preventDefault(),e.stopPropagation(),0!==this.subNodes.length&&(this.m_isExpanded?this.collapse():this.expand())},this.onExpanderClicked=e=>{this.m_isExpanded?this.collapse():this.expand()},this.m_parent=e,this.m_tree=null!==e?e.m_tree:s,this.m_level=t,this.container=new r.TreeNodeContainer(this.nodeFactory),this.m_isExpanded=!1,this.m_isSelected=!1,this.contentElmRef=new i.Ref}get tree(){return this.m_tree}get parent(){return this.m_parent}get level(){return this.m_level}get index(){return this.m_index}set index(e){this.m_index=e}get content(){return this.m_content}set content(e){this.m_content=e,this.updateMe()}get icon(){return this.m_icon}set icon(e){this.m_icon=e,this.updateMe()}get textColor(){return this.m_textColor}set textColor(e){this.m_textColor=e,this.updateMe()}get bgColor(){return this.m_bgColor}set bgColor(e){this.m_bgColor=e,this.updateMe()}get italic(){return this.m_italic}set italic(e){this.m_italic=e,this.updateMe()}get bold(){return this.m_bold}set bold(e){this.m_bold=e,this.updateMe()}get customClass(){return this.m_customClass}set customClass(e){this.m_customClass=e,this.updateMe()}get data(){return this.m_data}set data(e){this.m_data=e}get isExpanded(){return this.m_isExpanded}expand(){this.container.nodes.length>0&&!0!==this.m_isExpanded&&(this.m_isExpanded=!0,this.updateMe())}collapse(){this.container.nodes.length>0&&!1!==this.m_isExpanded&&(this.m_isExpanded=!1,this.updateMe())}select(){!0!==this.m_isSelected&&(null!=this.m_tree.m_selectedNode&&this.m_tree.m_selectedNode.unselect(),this.m_tree.m_selectedNode=this,this.m_isSelected=!0,this.updateMe())}unselect(){!1!==this.m_isSelected&&(this.m_tree.m_selectedNode=null,this.m_isSelected=!1,this.updateMe())}get subNodes(){return this.container.nodes}addNode(e,t){let s=this.container.addNode(e,t);return 1===this.container.nodes.length&&this.updateMe(),s}removeNode(e){let t=this.container.nodes.length;this.container.removeNode(e),1===t&&0===this.container.nodes.length&&(this.m_isExpanded=!1,this.updateMe())}removeAllNodes(){this.container.nodes.length>0&&(this.container.removeAllNodes(),this.m_isExpanded=!1,this.updateMe())}expandAll(){this.expand(),this.container.expandAll()}collapseAll(){this.collapse(),this.container.collapseAll()}scrollIntoView(e){if(!this.m_tree.elmRef.r||!this.contentElmRef.r)return;let t=this.m_tree.elmRef.r.getBoundingClientRect(),s=this.contentElmRef.r.getBoundingClientRect();s.bottom<=t.bottom&&s.top>=t.top||this.contentElmRef.r.scrollIntoView(e)}render(){return i.jsx(i.Fragment,null,this.renderNode(),this.renderSubNodes())}renderNode(){let e,t=0===this.container.nodes.length?"":this.m_isExpanded?"fa-caret-down":"fa-caret-right";this.m_icon&&("class"in this.m_icon?e=i.jsx("span",{class:this.m_tree.cssClassNodeIcon+" "+this.m_icon.class,click:this.onClick,dblclick:this.onDblClick}):"img"in this.m_icon&&(e=i.jsx("img",{class:this.m_tree.cssClassNodeIcon,src:this.m_icon.img,click:this.onClick,dblclick:this.onDblClick})));let s=this.m_isSelected?this.m_tree.cssClassNodeContentSelected:this.m_tree.cssClassNodeContent;this.m_customClass&&(s+=" "+this.m_customClass);let r={};return this.m_textColor&&(r.color=this.m_textColor),this.m_bgColor&&(r.backgroundColor=this.m_bgColor),this.m_italic&&(r.fontStyle="italic"),this.m_bold&&(r.fontWeight="bold"),i.jsx("div",{class:this.m_tree.cssClassNode},i.jsx("i",{class:"fa fa-fw "+t,click:this.onExpanderClicked}),e,i.jsx("span",{ref:this.contentElmRef,dragSource:!0,class:s,style:r,click:this.onClick,dblclick:this.onDblClick},this.m_content))}renderSubNodes(){return 0===this.subNodes.length?null:i.jsx("div",{class:this.m_tree.cssClassSubnodes,style:{display:this.m_isExpanded?"block":"none"}},this.container)}}t.TreeNode=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),r=s(5);t.VTable=class extends i.Component{constructor(e){super(e),this.minRowOverscan=3,this.optRowOverscan=5,this.maxRowOverscan=10,this.minColOverscan=3,this.optColOverscan=5,this.maxColOverscan=10,this.frameRef=e=>this.frame=e,this.wallRef=e=>this.wall=e,this.tableRef=e=>this.table=e,this.measureAndUpdate=()=>{if(0===this.rowCount||0===this.colCount)return;let e=this.frame.getBoundingClientRect(),t=this.wall.getBoundingClientRect(),s=this.table.getBoundingClientRect();if(this.latestScrollTop!=this.frame.scrollTop){let i=this.vAxis.measure(this.props.totalRowCount,this.firstRow,this.rowCount,this.avgRowHeight,e.height,t.height,s.height,this.frame.scrollTop);this.avgRowHeight=i.newAvgItemSize,this.latestScrollTop=this.frame.scrollTop,i.noAddRemoveNeeded||this.updateRows(i),i.newWallSize==t.height&&i.newSubsetOffset==s.top-t.top||this.callMe(()=>{this.table.style.top=i.newSubsetOffset+"px",this.wall.style.height=i.newWallSize+"px"},!1)}if(this.latestScrollLeft!=this.frame.scrollLeft){let i=this.hAxis.measure(this.props.totalColCount,this.firstCol,this.colCount,this.avgColWidth,e.width,t.width,s.width,this.frame.scrollLeft);this.avgColWidth=i.newAvgItemSize,this.latestScrollLeft=this.frame.scrollLeft,i.noAddRemoveNeeded||this.updateCols(i),i.newWallSize==t.width&&i.newSubsetOffset==s.left-t.left||this.callMe(()=>{this.table.style.left=i.newSubsetOffset+"px",this.wall.style.width=i.newWallSize+"px"},!1)}},this.onScroll=e=>{this.vn.scheduleCall(this.measureAndUpdate,!0)},this.avgRowHeight=0,this.avgColWidth=0,this.latestScrollTop=-1,this.latestScrollLeft=-1,this.wallHeight=25*this.props.totalRowCount,this.wallWidth=80*this.props.totalColCount}get rowCount(){return this.lastRow-this.firstRow+1}get colCount(){return this.lastCol-this.firstCol+1}get Rows(){return`${this.firstRow} - ${this.lastRow}`}get Cols(){return`${this.firstCol} - ${this.lastCol}`}willMount(){this.rows=[];let e=this.props.totalRowCount<10?this.props.totalRowCount:10,t=this.props.totalColCount<10?this.props.totalColCount:10;for(let s=0;s<e;s++){let e=new o;for(let i=0;i<t;i++)e.addCell(this.props.getCellCallback(s,i));this.rows.push(e)}this.firstRow=0,this.lastRow=e-1,this.firstCol=0,this.lastCol=t-1,this.vAxis=new r.ScrollAxis(this.minRowOverscan,this.optRowOverscan,this.maxRowOverscan),this.hAxis=new r.ScrollAxis(this.minColOverscan,this.optColOverscan,this.maxColOverscan)}render(){this.callMe(this.measureAndUpdate,!0);let e={width:`${this.wallWidth}px`,height:`${this.wallHeight}px`,overflow:"none",position:"relative"};return i.jsx("div",{ref:this.frameRef,style:{width:"100%",height:"100%",overflow:"auto"},scroll:this.onScroll},i.jsx("div",{ref:this.wallRef,style:e},i.jsx("table",{ref:this.tableRef,style:{position:"absolute",borderCollapse:"collapse",border:"1px solid black"}},this.rows)))}updateRows(e){if(e.neeedToRemoveAllItems){this.rows=[],console.log(`Removed all ${this.rowCount} existing rows`);for(let t=e.newFirst;t<=e.newLast;t++){let e=new o;for(let s=this.firstCol;s<=this.lastCol;s++)e.addCell(this.props.getCellCallback(t,s));this.rows.push(e)}console.log(`Add ${e.newLast-e.newFirst+1} rows`)}else{if(e.countToRemoveAtEnd>0&&(this.rows.splice(this.rowCount-e.countToRemoveAtEnd,e.countToRemoveAtEnd),console.log(`Removed ${e.countToRemoveAtEnd} rows from bottom`)),e.countToRemoveAtStart>0&&(this.rows.splice(0,e.countToRemoveAtStart),console.log(`Removed ${e.countToRemoveAtStart} rows from top`)),e.countToAddAtEnd>0){for(let t=this.lastRow+1;t<=e.newLast;t++){let e=new o;for(let s=this.firstCol;s<=this.lastCol;s++)e.addCell(this.props.getCellCallback(t,s));this.rows.push(e)}console.log(`Add ${e.countToAddAtEnd} rows to bottom`)}if(e.countToAddAtStart>0){for(let t=this.firstRow-1;t>=e.newFirst;t--){let e=new o;for(let s=this.firstCol;s<=this.lastCol;s++)e.addCell(this.props.getCellCallback(t,s));this.rows.splice(0,0,e)}console.log(`Add ${e.countToAddAtStart} rows to top`)}}this.firstRow=e.newFirst,this.lastRow=e.newLast,this.updateMe()}updateCols(e){if(e.neeedToRemoveAllItems){for(let t=this.firstRow;t<=this.lastRow;t++){let s=this.rows[t-this.firstRow];s.removeAllCells();for(let i=e.newFirst;i<=e.newLast;i++)s.addCell(this.props.getCellCallback(t,i));s.requestUpdate()}console.log(`Removed all ${this.colCount} existing cols`),console.log(`Add ${e.newLast-e.newFirst+1} cols`)}else{if(e.countToRemoveAtEnd>0){for(let t of this.rows)t.removeCellsAtEnd(e.countToRemoveAtEnd),t.requestUpdate();console.log(`Removed ${e.countToRemoveAtEnd} cols from right`)}if(e.countToRemoveAtStart>0){for(let t of this.rows)t.removeCellsAtStart(e.countToRemoveAtStart),t.requestUpdate();console.log(`Removed ${e.countToRemoveAtStart} cols from left`)}if(e.countToAddAtEnd>0){for(let t=this.firstRow;t<=this.lastRow;t++){let s=this.rows[t-this.firstRow];for(let i=this.lastCol+1;i<=e.newLast;i++)s.addCell(this.props.getCellCallback(t,i));s.requestUpdate()}console.log(`Add ${e.countToAddAtEnd} cols to right`)}if(e.countToAddAtStart>0){for(let t=this.firstRow;t<=this.lastRow;t++){let s=this.rows[t-this.firstRow];for(let i=this.firstCol-1;i>=e.newFirst;i--)s.insertCell(this.props.getCellCallback(t,i));s.requestUpdate()}console.log(`Add ${e.countToAddAtStart} cols to left`)}}this.firstCol=e.newFirst,this.lastCol=e.newLast}};class o extends i.Component{constructor(){super(),this.cells=[]}addCell(e){this.cells.push(new n(e))}insertCell(e){this.cells.splice(0,0,new n(e))}removeAllCells(){this.cells=[]}removeCellsAtStart(e){this.cells.splice(0,e)}removeCellsAtEnd(e){this.cells.splice(this.cells.length-e,e)}requestUpdate(){this.updateMe()}render(){return i.jsx("tr",null,this.cells)}}class n extends i.Component{constructor(e){super(),this.data="object"==typeof e&&"content"in e?e:{content:e}}render(){return i.jsx("td",{class:this.data.class,style:this.data.style,rowspan:this.data.rowSpan?this.data.rowSpan:void 0,colspan:this.data.colSpan?this.data.colSpan:void 0},this.data.content)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),r=s(16),o=s(17);class n{constructor(e,t){this.elmVN=e,this.currVal=t,this.add(t)}terminate(e){this.remove(),this.elmVN=void 0}update(e){return this.currVal!==e&&(this.currVal&&this.remove(),e&&this.add(e),this.currVal=e,!0)}add(e){let t=this.elmVN.elm;this.dragSourceHandler="ownerSVGElement"in t?new r.DragSourceEmulator(t,e):new r.DragSourceHandler(t,e),this.dragSourceHandler.init()}remove(){this.dragSourceHandler&&(this.dragSourceHandler.term(),this.dragSourceHandler=void 0)}}class a{constructor(e,t){this.elmVN=e,this.currVal=t,this.add(t)}terminate(e){this.remove(),this.elmVN=void 0}update(e){return this.currVal!==e&&(this.currVal&&this.remove(),e&&this.add(e),this.currVal=e,!0)}add(e){let t=this.elmVN.elm;this.dragTargetHandler=new o.DragTargetHandler(t,e),this.dragTargetHandler.init()}remove(){this.dragTargetHandler&&(this.dragTargetHandler.term(),this.dragTargetHandler=void 0)}}t.registerDragDropCustomAttributes=function(){i.registerCustomAttribute("dragSource",n),i.registerCustomAttribute("dragTarget",a)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(0),r=s(1),o=s(6);class n{get dragEvent(){return this.m_dragEvent}set dragEvent(e){this.m_dragEvent=e}setData(e,t){"string"==typeof t?this.m_dragEvent.dataTransfer.setData(e,t):(this.m_dragEvent.dataTransfer.setData(e,""),o.DragAndDropData.setObjectData(e,t))}}class a{constructor(e,t){this.onDragStart=e=>{if(o.DragAndDropData.clearAllObjectData(),this.dragSourceEvent.dragEvent=e,2===this.behavior){for(let e in this.simpleDragSource.data)this.dragSourceEvent.setData(e,this.simpleDragSource.data[e]);void 0!==this.simpleDragSource.allowedEffects?e.dataTransfer.effectAllowed=this.simpleDragSource.allowedEffects:e.dataTransfer.effectAllowed="all"}else if(1===this.behavior)try{this.dragSource.onDragStart&&this.dragSource.onDragStart(this.dragSourceEvent)}catch(e){throw o.DragAndDropData.clearAllObjectData(),e}else this.dragSourceEvent.setData(r.DNDTYPE_ELEMENT,this.elm),e.dataTransfer.effectAllowed="all",3===this.behavior?this.dragSourceEvent.setData("text/plain",this.elm.textContent):4===this.behavior&&this.dragSourceEvent.setData("text/plain",this.elm.outerHTML)},this.onDragEnd=e=>{if(1===this.behavior)try{this.dragSource.onDragEnd&&(this.dragSourceEvent.dragEvent=e,this.dragSource.onDragEnd(this.dragSourceEvent))}finally{o.DragAndDropData.clearAllObjectData()}else o.DragAndDropData.clearAllObjectData()},this.onDrag=e=>{1===this.behavior&&this.dragSource.onDrag&&(this.dragSourceEvent.dragEvent=e,this.dragSource.onDrag(this.dragSourceEvent))},this.elm=e,"elm-text"===t?this.behavior=3:"elm-html"===t||!0===t?this.behavior=4:void 0!==t.data?(this.behavior=2,this.simpleDragSource=t):void 0!==t.onDragStart&&(this.behavior=1,this.dragSource=t)}init(){this.dragSourceEvent=new n,this.elm.setAttribute("draggable","true"),this.elm.addEventListener("dragstart",this.onDragStart),this.elm.addEventListener("dragend",this.onDragEnd),this.elm.addEventListener("drag",this.onDrag)}term(){this.elm.removeEventListener("dragstart",this.onDragStart),this.elm.removeEventListener("dragend",this.onDragEnd),this.elm.removeEventListener("drag",this.onDrag),this.elm.removeAttribute("draggable"),this.dragSourceEvent=void 0}}t.DragSourceHandler=a;t.DragSourceEmulator=class extends a{constructor(e,t){super(e,t),this.onMouseDown=e=>{0===e.button&&(e.preventDefault(),this.mouseDownX=e.clientX,this.mouseDownY=e.clientY,document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp))},this.onMouseMove=e=>{if(0!=(1&e.buttons))if(e.preventDefault(),void 0!==this.emulDataTransfer)this.handleDragStep(e);else{let t=e.clientX-this.mouseDownX,s=e.clientY-this.mouseDownY;if(t>=-2&&t<=2&&s>=-2&&s<=2)return;this.initiateDragOperation(e)}},this.onMouseUp=e=>{void 0!==this.emulDataTransfer&&this.handleDrop(e),this.cleanupDragOperation()},this.onKeyDown=e=>{e.preventDefault(),e.stopPropagation(),27===e.keyCode?(void 0!==this.emulDataTransfer&&this.cancelDragOperation(e),this.cleanupDragOperation()):void 0!==this.emulDataTransfer&&this.handleKeyEvent(e)},this.onKeyUp=e=>{e.preventDefault(),e.stopPropagation(),void 0!==this.emulDataTransfer&&this.handleKeyEvent(e)}}init(){super.init(),this.elm.addEventListener("mousedown",this.onMouseDown)}term(){super.term(),this.elm.removeEventListener("mousedown",this.onMouseDown)}initiateDragOperation(e){"setDragImage"in DataTransfer.prototype?this.emulDataTransfer=new o.EmulDataTransfer:this.emulDataTransfer=new o.EmulLegacyDataTransfer;let t=this.createDragEventFromMouseEvent(e,"dragstart");if(this.elm.dispatchEvent(t),t.defaultPrevented)this.cleanupDragOperation();else{if(!this.emulDataTransfer.isImageElmReset){let t=this.elm.getBoundingClientRect();this.emulDataTransfer.setDragImage(this.elm,e.clientX-t.left,e.clientY-t.top)}this.lastTarget=void 0,this.isLastTargetDroppable=!1,this.isDropPossibleOnLastTarget=!1,this.handleDragStep(e)}}handleDragStep(e){this.emulDataTransfer.isImageElmReset&&(this.prepareImageElement(),this.emulDataTransfer.isImageElmReset=!1),this.emulDataTransfer.dropEffect="none",this.imageElm&&(this.imageElm.hidden=!0);let t=document.elementFromPoint(e.clientX,e.clientY);if(this.imageElm&&(this.imageElm.hidden=!1),t)if(t===this.lastTarget){if(this.isLastTargetDroppable){let s=this.createDragEventFromMouseEvent(e,"dragover");t.dispatchEvent(s),this.isDropPossibleOnLastTarget=s.defaultPrevented}}else{let s=this.createDragEventFromMouseEvent(e,"dragenter");t.dispatchEvent(s);let i=s.defaultPrevented;if(this.lastTarget&&this.isLastTargetDroppable&&this.lastTarget.dispatchEvent(this.createDragEventFromMouseEvent(e,"dragleave")),this.lastTarget=t,this.isLastTargetDroppable=i,this.isDropPossibleOnLastTarget=i,this.isLastTargetDroppable){let s=this.createDragEventFromMouseEvent(e,"dragover");t.dispatchEvent(s),this.isDropPossibleOnLastTarget=s.defaultPrevented}}else this.lastTarget&&(this.isLastTargetDroppable&&this.lastTarget.dispatchEvent(this.createDragEventFromMouseEvent(e,"dragleave")),this.lastTarget=void 0,this.isLastTargetDroppable=!1,this.isDropPossibleOnLastTarget=!1);if(this.elm.dispatchEvent(this.createDragEventFromMouseEvent(e,"drag")),this.imageElm&&(this.imageElm.style.left=e.clientX-this.emulDataTransfer.imageElmX+"px",this.imageElm.style.top=e.clientY-this.emulDataTransfer.imageElmY+"px"),this.dropEffectElm){let e=this.isDropPossibleOnLastTarget?this.emulDataTransfer.dropEffect:"none";this.setDropEffectImageCue(e),this.dropEffectElm.style.left=this.emulDataTransfer.imageElmX+12+"px",this.dropEffectElm.style.top=this.emulDataTransfer.imageElmY+0+"px"}this.lastMouseEvent=e}handleKeyEvent(e){if(this.lastTarget&&this.isLastTargetDroppable){let t=this.createDragEventFromKeyboardEvent(e,"dragover");if(this.lastTarget.dispatchEvent(t),this.isDropPossibleOnLastTarget=t.defaultPrevented,this.elm.dispatchEvent(this.createDragEventFromKeyboardEvent(e,"drag")),this.dropEffectElm){let e=this.isDropPossibleOnLastTarget?this.emulDataTransfer.dropEffect:"none";this.setDropEffectImageCue(e)}}}prepareImageElement(){this.imageElm&&(this.imageElm.remove(),this.imageElm);let e=this.emulDataTransfer.imageElm;if(!e)return;let t=document.createElement("div"),s=e.cloneNode();if(i.isSvg(e)&&!i.isSvgSvg(e)){let e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.appendChild(s),t.appendChild(e)}else t.appendChild(s);t.style.opacity="0.7",t.style.position="absolute",this.dropEffectElm=document.createElement("span"),this.dropEffectElm.style.position="absolute",t.appendChild(this.dropEffectElm),document.body.appendChild(t),this.imageElm=t;let r=s.getBoundingClientRect(),o=t.getBoundingClientRect();r.left!=o.left&&(this.emulDataTransfer.imageElmX+=r.left-o.left),r.top!=o.top&&(this.emulDataTransfer.imageElmY+=r.top-o.top)}setDropEffectImageCue(e){let t,s;switch(e){case"none":t="fa fa-fw fa-ban",s="red";break;case"copy":t="fa fa-fw fa-plus",s="green";break;case"link":t="fa fa-fw fa-link",s="blue";break;default:t="",s="black"}this.dropEffectElm.className=t,this.dropEffectElm.style.color=s}handleDrop(e){this.lastTarget?this.isDropPossibleOnLastTarget?this.lastTarget.dispatchEvent(this.createDragEventFromMouseEvent(e,"drop")):this.isLastTargetDroppable?this.lastTarget.dispatchEvent(this.createDragEventFromMouseEvent(e,"dragleave")):this.emulDataTransfer.dropEffect="none":this.emulDataTransfer.dropEffect="none",this.elm.dispatchEvent(this.createDragEventFromMouseEvent(e,"dragend"))}cancelDragOperation(e){this.emulDataTransfer.dropEffect="none",this.lastTarget&&this.isLastTargetDroppable&&this.lastTarget.dispatchEvent(this.createDragEventFromKeyboardEvent(e,"dragleave")),this.elm.dispatchEvent(this.createDragEventFromKeyboardEvent(e,"dragend"))}cleanupDragOperation(){this.emulDataTransfer=void 0,document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),this.lastTarget=void 0,this.isLastTargetDroppable=!1,this.isDropPossibleOnLastTarget=!1,this.lastMouseEvent=void 0,this.imageElm&&(this.imageElm.remove(),this.imageElm=void 0)}createDragEventFromMouseEvent(e,t){if("initDragEvent"in DragEvent.prototype){let s=document.createEvent("DragEvent");return s.initDragEvent(t,e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget,this.emulDataTransfer),s}return new DragEvent(t,{bubbles:e.bubbles,cancelable:e.cancelable,detail:e.detail,view:e.view,altKey:e.altKey,button:e.button,buttons:e.buttons,clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,metaKey:e.metaKey,relatedTarget:e.relatedTarget,screenX:e.screenX,screenY:e.screenY,shiftKey:e.shiftKey,dataTransfer:this.emulDataTransfer})}createDragEventFromKeyboardEvent(e,t){if("initDragEvent"in DragEvent.prototype){let s=document.createEvent("DragEvent");return s.initDragEvent(t,e.bubbles,e.cancelable,e.view,e.detail,this.lastMouseEvent.screenX,this.lastMouseEvent.screenY,this.lastMouseEvent.clientX,this.lastMouseEvent.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,this.lastMouseEvent.button,this.lastMouseEvent.relatedTarget,this.emulDataTransfer),s}return new DragEvent(t,{bubbles:e.bubbles,cancelable:e.cancelable,detail:e.detail,view:e.view,altKey:e.altKey,button:this.lastMouseEvent.button,buttons:this.lastMouseEvent.buttons,clientX:this.lastMouseEvent.clientX,clientY:this.lastMouseEvent.clientY,ctrlKey:e.ctrlKey,metaKey:e.metaKey,relatedTarget:this.lastMouseEvent.relatedTarget,screenX:this.lastMouseEvent.screenX,screenY:this.lastMouseEvent.screenY,shiftKey:e.shiftKey,dataTransfer:this.emulDataTransfer})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=s(6);class r{get dragEvent(){return this.m_dragEvent}set dragEvent(e){this.m_dragEvent=e}hasType(e){return i.DragAndDropData.hasType(this.dragEvent.dataTransfer,e)}getData(e){let t=i.DragAndDropData.getObjectData(e);return void 0!==t?t:this.m_dragEvent.dataTransfer.getData(e)}hasFiles(){let e=this.m_dragEvent.dataTransfer.files;return e&&e.length>0}getFiles(){let e=this.m_dragEvent.dataTransfer.items;if(!e||0===e.length)return;let t=[];if(e)for(let s=0;s<e.length;s++)t.push(e[s].webkitGetAsEntry());return t}}t.DragTargetHandler=class{constructor(e,t){this.onDragEnter=e=>{if(e.stopPropagation(),this.dragTargetEnterCounter++>0)this.isDropPossible&&e.preventDefault();else{if(this.isDropPossible=!1,void 0!==this.simpleDragTarget){for(let t of this.simpleDragTarget.dataTypes)if(i.DragAndDropData.hasType(e.dataTransfer,t)){this.isDropPossible=!0;break}if(!this.isDropPossible)return}else void 0!==this.dragTarget&&(void 0===this.dragTarget.onDragEnter?this.isDropPossible=!0:(this.dragTargetEvent.dragEvent=e,this.isDropPossible=this.dragTarget.onDragEnter(this.dragTargetEvent)));if(this.isDropPossible)if(e.preventDefault(),void 0!==this.simpleDragTarget){if(void 0!==this.simpleDragTarget.feedback){let e=this.elm.style;this.savedStyle={};for(let t in this.simpleDragTarget.feedback)this.savedStyle[t]=e[t],e[t]=this.simpleDragTarget.feedback[t]}}else void 0!==this.dragTarget&&void 0===this.dragTarget.onDragEnter&&(e.dataTransfer.dropEffect=this.getDefaultDropEffect(e))}},this.onDragOver=e=>{e.stopPropagation();let t=!1;void 0!==this.simpleDragTarget?t=!0:void 0!==this.dragTarget&&(void 0===this.dragTarget.onDragOver?t=!0:(this.dragTargetEvent.dragEvent=e,t=this.dragTarget.onDragOver(this.dragTargetEvent))),t&&(e.preventDefault(),void 0!==this.simpleDragTarget?e.dataTransfer.dropEffect=this.getDefaultDropEffect(e):void 0!==this.dragTarget&&void 0===this.dragTarget.onDragOver&&(e.dataTransfer.dropEffect=this.getDefaultDropEffect(e)))},this.onDragLeave=e=>{if(e.preventDefault(),e.stopPropagation(),!(--this.dragTargetEnterCounter>0))if(void 0!==this.simpleDragTarget){if(void 0!==this.savedStyle){let e=this.elm.style;for(let t in this.savedStyle)e[t]=this.savedStyle[t];this.savedStyle=void 0}}else void 0!==this.dragTarget&&void 0!==this.dragTarget.onDragLeave&&(this.dragTargetEvent.dragEvent=e,this.dragTarget.onDragLeave(this.dragTargetEvent))},this.onDrop=e=>{if(e.preventDefault(),e.stopPropagation(),void 0!==this.simpleDragTarget){let t=this.simpleDragTarget.dataTypes,s={};for(let r of e.dataTransfer.types){if(t&&t.length>0&&t.indexOf(r)<0)continue;let o=i.DragAndDropData.getObjectData(r);void 0!==o?s[r]=o:void 0!==(o=e.dataTransfer.getData(r))&&(s[r]=o)}this.simpleDragTarget.onDataDropped(s)}else void 0!==this.dragTarget&&(this.dragTargetEvent.dragEvent=e,this.dragTarget.onDrop(this.dragTargetEvent));this.dragTargetEnterCounter=0},this.elm=e,void 0!==t.onDrop?this.dragTarget=t:void 0!==t.onDataDropped&&(this.simpleDragTarget=t)}init(){this.dragTargetEvent=new r,this.dragTargetEnterCounter=0,this.elm.addEventListener("dragenter",this.onDragEnter),this.elm.addEventListener("dragleave",this.onDragLeave),this.elm.addEventListener("dragover",this.onDragOver),this.elm.addEventListener("drop",this.onDrop)}term(){this.elm.removeEventListener("dragenter",this.onDragEnter),this.elm.removeEventListener("dragleave",this.onDragLeave),this.elm.removeEventListener("dragover",this.onDragOver),this.elm.removeEventListener("drop",this.onDrop),this.dragTargetEvent=void 0}getDefaultDropEffect(e){switch(e.dataTransfer.effectAllowed){case"copy":return"copy";case"move":return"move";case"link":return"link";case"copyMove":return e.ctrlKey?"copy":"move";case"copyLink":return e.altKey?"link":"copy";case"linkMove":return e.altKey?"link":"move";case"all":return e.altKey?"link":e.ctrlKey?"copy":"move"}}isDropEffectAllowed(e,t){switch(t){case"copy":return"copy"===e;case"move":return"move"===e;case"link":return"link"===e;case"copyMove":return"copy"===e||"move"===e;case"copyLink":return"copy"===e||"link"===e;case"linkMove":return"link"===e||"move"===e;case"all":return"none"!==e;default:return!1}}}}])});
//# sourceMappingURL=mimcl.js.map